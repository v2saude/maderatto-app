<!DOCTYPE html>
<html>

<head>
<meta charset="utf-8" />
<meta name="format-detection" content="telephone=no" />
<meta name="msapplication-tap-highlight" content="no" />
<meta name="viewport"
	content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
<!-- This is a wide open CSP declaration. To lock this down for production, see below. -->
<meta http-equiv="Content-Security-Policy" content="default-src * gap: file:; style-src 'self' 'unsafe-inline'; img-src 'self' data:; script-src * 'unsafe-inline' 'unsafe-eval'">

<link rel="stylesheet" href="css/jquery.mobile-1.4.5.css">
<link rel="stylesheet" href="css/jquery.mobile.icons.min.css">
<link rel="stylesheet" href="css/maderatto.css">

<script src="js/jquery.min.js"></script>
<script src="js/jquery.mobile-1.4.5.min.js"></script>
<script src="js/index.js"></script>
<script src="cordova.js"></script>

<title>Maderatto</title>
<script>
	function verificaUsuario(){
		if(window.localStorage.getItem("matricula") != null ){
			window.location.href="home.html";
		}else
			$("#page-login").css('display', 'block');
	}
</script>
</head>
<body onload="verificaUsuario();">
	<div class="app">
		<div data-role="page" id="page-login" style="display: none;">
			<div class="page-login">
				<div class="top-header">
					<div class="logo">
						<img alt="" src="img/logo.png">
					</div>
				</div>
				<div role="main" class="ui-content">
					<div class="ui-grid-solo formulario-login">
						<figure class="gif-load" style="display: none;">
								<img src="img/images/giphy.gif" />
							</figure>
						<div class="ui-block-a" id="form-login">
							<form action="" method="post">
								<label for="matricula">Matrícula</label>
								<input name="matricula" id="matricula" value="" type="number">
								
								<label for="senha">Senha</label>
								<input type="password" name="senha" id="senha">

								<div class="ui-block-a">
									<button class="ui-shadow ui-btn ui-corner-all" type="button"
										onclick="loginApp()">Entrar</button>
								</div>
							</form>
						</div>
					</div>
				</div>
				<div class="mobile-bottom-bar" data-theme="a" data-position="fixed">
					<a href="#" data-rel="popup" data-position-to="window" data-transition="fade" id="modalConfig">
						<span class="ui-btn-icon-right ui-icon-configuracao"></span>
					</a>
				
					<!-- The Modal -->
					<div id="configModal" class="modal">
					
					  <!-- Modal content -->
					  <div class="modal-content" style="width:300px;">
					    <span class="close">&times;</span>
					    	<br/>
					    	<label for="base-url">Endereço (URL) do sistema</label>
					    	<input name="baseUrl" id="base-url" value="" type="text">
					   
							<button class="ui-shadow ui-btn ui-corner-all" style="background-color:#9FB33C" type="button"
								onclick="salvarBaseUrl()">Salvar</button>
							<button class="ui-shadow ui-btn ui-corner-all" style="background-color:#9FB33C" type="button"
								onclick="restaurarBaseUrlPadrao()">Restaurar padrão</button>
					  </div>
					
					</div>
				</div>				
			</div>
		</div>
	</div>
	<script type="text/javascript">app.initialize();</script>
	<script>
		// Pega o modal
		var modal = document.getElementById('configModal');
	
		// Pega o botão que abre o modal
		var btn = document.getElementById("modalConfig");
	
		// Pega o elemento <span> que fecha o modal
		var span = document.getElementsByClassName("close")[0];
	
		// Quando o usuário clicar no botão, o modal abre
		btn.onclick = function() {
		    modal.style.display = "block";
		    $("#base-url").val(window.localStorage.getItem("baseUrl"));
		}
	
		// Quando o usuário clicar no X do <span>, o modal fechará
		span.onclick = function() {
		    modal.style.display = "none";
		}
	
		// Quando o usuário clicar fora do modal, ele fechará
		window.onclick = function(event) {
		    if (event.target == modal) {
		        modal.style.display = "none";
		    }
		} 
	</script>
</body>
</html>